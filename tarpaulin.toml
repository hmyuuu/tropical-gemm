# Tarpaulin coverage configuration
#
# Run with: cargo tarpaulin
# Or for CPU-only coverage excluding CUDA:
#   cargo tarpaulin --exclude-files "crates/tropical-gemm-cuda/*"

[default]
# Use LLVM engine for better inline function coverage
engine = "Llvm"

# Run for whole workspace
workspace = true

# Exclude CUDA crate from testing (requires GPU)
exclude = ["tropical-gemm-cuda"]

# Exclude architecture-specific code (cannot be tested on single machine)
# and CUDA crate (requires GPU hardware)
exclude-files = [
    "*/simd/detect.rs",         # CPU feature detection
    "*/simd/dispatch.rs",       # Architecture-specific kernel dispatch
    "*/backend.rs",             # SIMD level reporting
    "*/tropical-gemm-cuda/*",   # CUDA crate (requires GPU)
    "*/mat/mut_.rs",            # MatMut: mostly debug_assert bounds checking
]

# Skip lines in panic/assert format strings and debug_assert blocks
# These are defensive code that only runs on programmer error
ignore-panics = true
