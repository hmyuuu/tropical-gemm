# Test Fixtures

This directory contains ground-truth test data generated by TropicalNumbers.jl for validating the Rust/Python implementation.

## Regenerating Fixtures

If you need to regenerate the fixtures (e.g., after changing test parameters):

```bash
cd crates/tropical-gemm-python/tests/fixtures
julia julia_generator.jl
```

### Requirements

- Julia 1.6+
- TropicalNumbers.jl (auto-installed by script)
- JSON3.jl (auto-installed by script)

### Installing Julia

```bash
# Ubuntu/Debian
sudo apt install julia

# macOS
brew install julia

# Or download from https://julialang.org/downloads/
```

## Directory Structure

```
fixtures/
├── julia_generator.jl      # Generation script
├── README.md               # This file
├── maxplus_f32/            # MaxPlus with Float32
│   ├── square_4.json
│   ├── square_16.json
│   ├── square_64.json
│   ├── square_256.json
│   ├── rect_32x64x48.json
│   ├── batched_square_16_b3.json
│   ├── batched_square_64_b3.json
│   └── special_negative_*.json
├── maxplus_f64/            # MaxPlus with Float64
├── minplus_f32/            # MinPlus with Float32
├── minplus_f64/            # MinPlus with Float64
├── maxmul_f32/             # MaxMul with Float32
├── maxmul_f64/             # MaxMul with Float64
├── andor_bool/             # Boolean AND/OR semiring
└── counting_f32/           # CountingTropical with Float32
```

## JSON Format

### Non-batched

```json
{
  "algebra": "maxplus",
  "scalar": "f32",
  "m": 16,
  "k": 16,
  "n": 16,
  "batch_size": null,
  "a": [[...], ...],           // m×k matrix (row-major)
  "b": [[...], ...],           // k×n matrix (row-major)
  "c_expected": [[...], ...],  // m×n result matrix
  "argmax_expected": [[...], ...]  // m×n argmax indices (0-indexed)
}
```

### Batched

```json
{
  "algebra": "maxplus",
  "scalar": "f32",
  "m": 16,
  "k": 16,
  "n": 16,
  "batch_size": 3,
  "a": [[[...], ...], ...],           // batch×m×k
  "b": [[[...], ...], ...],           // batch×k×n
  "c_expected": [[[...], ...], ...],  // batch×m×n
  "argmax_expected": [[[...], ...], ...]  // batch×m×n
}
```

### CountingTropical

For CountingTropical, values in `c_expected` are `[value, count]` pairs:

```json
{
  "c_expected": [[[1.5, 2], [3.0, 1]], ...]  // Each element is [value, count]
}
```

## Notes

- All matrices are stored in **row-major order** (C-contiguous) for NumPy/Rust compatibility
- Argmax indices are **0-indexed** for Python compatibility
- Random seed is fixed at 42 for reproducibility
- Float values use the same random distribution across runs
